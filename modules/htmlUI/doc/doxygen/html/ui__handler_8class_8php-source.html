<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>LiveSupport&amp;nbsp;-&amp;nbsp;htmlUI&amp;nbsp;module: ui_handler.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">var</a></div>
<h1>ui_handler.class.php</h1><a href="ui__handler_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 &lt;?php
<a name="l00007"></a><a class="code" href="classuiHandler.html">00007</a> <span class="keyword">class </span><a class="code" href="classuiHandler.html">uiHandler</a> <span class="keyword">extends</span> <a class="code" href="classuiBase.html">uiBase</a> {
<a name="l00008"></a><a class="code" href="classuiHandler.html#o0">00008</a>     var <a class="code" href="classuiHandler.html#o0">$redirUrl</a>;
<a name="l00009"></a><a class="code" href="classuiHandler.html#o1">00009</a>     var <a class="code" href="classuiHandler.html#o1">$alertMsg</a>;
00010 
<a name="l00011"></a><a class="code" href="classuiHandler.html#a0">00011</a>     function <a class="code" href="classuiHandler.html#a0">uiHandler</a>($config)
00012     {
00013         $dbc = DB::connect($config['dsn'], TRUE);
00014         $dbc-&gt;setFetchMode(DB_FETCHMODE_ASSOC);
00015         $this-&gt;gb = &amp;<span class="keyword">new</span> GreenBox(&amp;$dbc, $config);
00016         $this-&gt;<span class="keywordtype">id</span> = (!<a class="code" href="ui__handler_8php.html#a11">$_REQUEST</a>['<span class="keywordtype">id</span>'] ? $this-&gt;gb-&gt;storId : <a class="code" href="ui__handler_8php.html#a11">$_REQUEST</a>['<span class="keywordtype">id</span>']);
00017         $this-&gt;sessid = <a class="code" href="ui__handler_8php.html#a11">$_REQUEST</a>[<a class="code" href="conf_8php.html#a0">$config</a>['authCookieName']];
00018         $this-&gt;userid = $this-&gt;gb-&gt;getSessUserId($this-&gt;sessid);
00019         $this-&gt;<a class="code" href="classuiHandler.html#a1">login</a>  = $this-&gt;gb-&gt;getSessLogin ($this-&gt;sessid);
00020         $this-&gt;config = <a class="code" href="conf_8php.html#a0">$config</a>;
00021     }
00022 
00023     <span class="comment">// --- authentication ---</span>
<a name="l00033"></a><a class="code" href="classuiHandler.html#a1">00033</a> <span class="comment"></span>    function <a class="code" href="classuiHandler.html#a1">login</a>(&amp;$formdata, &amp;$mask)
00034     {    $formdata['xxx'] = 'yyy';
00035         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>;
00036         <span class="keywordflow">if</span> ($this-&gt;_validateForm($formdata, $mask)) {
00037             $sessid = $this-&gt;gb-&gt;login($formdata['<a class="code" href="classuiHandler.html#a1">login</a>'], $formdata['pass']);
00038             <span class="keywordflow">if</span>($sessid &amp;&amp; !PEAR::isError($sessid)){
00039                 setcookie($this-&gt;config['authCookieName'], $sessid);
00040 
00041                 $fid = $this-&gt;gb-&gt;getObjId($formdata['login'], $this-&gt;gb-&gt;storId);
00042                 <span class="keywordflow">if</span>(!PEAR::isError($fid)) $this-&gt;redirUrl.=<span class="stringliteral">"?id=$fid"</span>;
00043             }<span class="keywordflow">else</span>{
00044                 $this-&gt;alertMsg = 'Login failed.';
00045             }
00046         }
00047 
00048     }
00049 
<a name="l00056"></a><a class="code" href="classuiHandler.html#a2">00056</a>     function <a class="code" href="classuiHandler.html#a2">logout</a>()
00057     {
00058         $this-&gt;gb-&gt;logout($this-&gt;sessid);
00059         setcookie($this-&gt;config['authCookieName'], '');
00060         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>;
00061     }
00062 
00063     <span class="comment">// --- files ---</span>
<a name="l00074"></a><a class="code" href="classuiHandler.html#a3">00074</a> <span class="comment"></span>    function <a class="code" href="classuiHandler.html#a3">upload</a>(&amp;$formdata, $<span class="keywordtype">id</span>, &amp;$mask)
00075     {
00076         <span class="keywordflow">if</span> ($this-&gt;_validateForm($formdata, $mask)) {
00077             $tmpgunid = md5(
00078                 microtime().$_SERVER['SERVER_ADDR'].rand().<span class="stringliteral">"org.mdlf.livesupport"</span>
00079             );
00080             $ntmp = $this-&gt;gb-&gt;bufferDir.<span class="charliteral">'/'</span>.$tmpgunid;
00081 <span class="preprocessor">            #        $ntmp = tempnam(""{$gb-&gt;bufferDir}", 'gbTmp_');</span>
00082 <span class="preprocessor"></span>            $mdtmp = <span class="stringliteral">""</span>;
00083             move_uploaded_file($formdata['mediafile']['tmp_name'], $ntmp);
00084             chmod($ntmp, 0664);
00085             <span class="keywordflow">if</span>($formdata['mdatafile']['tmp_name']){
00086                 $mdtmp = <span class="stringliteral">"$ntmp.xml"</span>;
00087                 <span class="keywordflow">if</span>(move_uploaded_file($formdata['mdatafile']['tmp_name'], $mdtmp)){
00088                     chmod($mdtmp, 0664);
00089                 }
00090             }
00091             $r = $this-&gt;gb-&gt;putFile($<span class="keywordtype">id</span>, $formdata['filename'], $ntmp, $mdtmp, $this-&gt;sessid);
00092             <span class="keywordflow">if</span>(PEAR::isError($r)) $this-&gt;alertMsg = $r-&gt;getMessage();
00093             <span class="keywordflow">else</span>{
00094 <span class="preprocessor">            #            $gb-&gt;updateMetadataDB($gb-&gt;_pathFromId($r), $mdata, $sessid);</span>
00095 <span class="preprocessor"></span>                @unlink($ntmp);
00096                 @unlink($mdtmp);
00097             }
00098             $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id="</span>.$id;
00099          } <span class="keywordflow">else</span> {
00100             $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?act=newfile&amp;id="</span>.$id;
00101          }
00102     }
00103 
<a name="l00112"></a><a class="code" href="classuiHandler.html#a4">00112</a>     function <a class="code" href="classuiHandler.html#a4">newFolder</a>($newname, $<span class="keywordtype">id</span>)
00113     {
00114         $r = $this-&gt;gb-&gt;createFolder($<span class="keywordtype">id</span>, $newname, $this-&gt;sessid);
00115         <span class="keywordflow">if</span>(PEAR::isError($r)) $this-&gt;alertMsg = $r-&gt;getMessage();
00116         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?<span class="keywordtype">id</span>='.$id;
00117     }
00118 
<a name="l00127"></a><a class="code" href="classuiHandler.html#a5">00127</a>     function <a class="code" href="classuiHandler.html#a5">rename</a>($newname, $<span class="keywordtype">id</span>)
00128     {
00129         $parid = $this-&gt;gb-&gt;getparent($this-&gt;id);
00130         $r = $this-&gt;gb-&gt;renameFile($<span class="keywordtype">id</span>, $newname, $this-&gt;sessid);
00131         <span class="keywordflow">if</span>(PEAR::isError($r)) $this-&gt;alertMsg = $r-&gt;getMessage();
00132         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$parid"</span>;
00133     }
00134 
<a name="l00144"></a><a class="code" href="classuiHandler.html#a6">00144</a>     function <a class="code" href="classuiHandler.html#a6">move</a>($newPath, $<span class="keywordtype">id</span>)
00145     {
00146         $newPath = urlencode($newPath);
00147         $did = $this-&gt;gb-&gt;getObjIdFromRelPath($<span class="keywordtype">id</span>, $newPath);
00148         $parid = $this-&gt;gb-&gt;getparent($<span class="keywordtype">id</span>);
00149         $r = $this-&gt;gb-&gt;moveFile($<span class="keywordtype">id</span>, $did, $this-&gt;sessid);
00150         <span class="keywordflow">if</span>(PEAR::isError($r)){
00151             $this-&gt;alertMsg = $r-&gt;getMessage();
00152             $this-&gt;redirUrl  = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$parid"</span>;
00153         }
00154         <span class="keywordflow">else</span> $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$did"</span>;
00155     }
00156 
<a name="l00166"></a><a class="code" href="classuiHandler.html#a7">00166</a>     function <a class="code" href="classuiHandler.html#a7">copy</a>($newPath, $<span class="keywordtype">id</span>)
00167     {
00168         $newPath = urldecode($newPath);
00169         $did = $this-&gt;gb-&gt;getObjIdFromRelPath($<span class="keywordtype">id</span>, $newPath);
00170         $parid = $this-&gt;gb-&gt;getparent($<span class="keywordtype">id</span>);
00171         $r = $this-&gt;gb-&gt;copyFile($<span class="keywordtype">id</span>, $did, $this-&gt;sessid);
00172         <span class="keywordflow">if</span>(PEAR::isError($r)){
00173             $this-&gt;alertMsg = $r-&gt;getMessage();
00174             $this-&gt;redirUrl  = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$parid"</span>;
00175         }
00176         <span class="keywordflow">else</span> $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$did"</span>;
00177     }
00178 
<a name="l00187"></a><a class="code" href="classuiHandler.html#a8">00187</a>     function <span class="keyword">delete</span>($id, $delOverride=FALSE)
00188     {
00189         $parid = $this-&gt;gb-&gt;getparent($<span class="keywordtype">id</span>);
00190 
00191 <span class="preprocessor">        ## add emtyness-test here ###</span>
00192 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (!($delOverride==$<span class="keywordtype">id</span>) &amp;&amp; (count($this-&gt;gb-&gt;getObjType($<span class="keywordtype">id</span>)=='Folder'?
00193                       $this-&gt;gb-&gt;listFolder($<span class="keywordtype">id</span>, $this-&gt;sessid):NULL))) {
00194             $this-&gt;alertMsg = $this-&gt;<a class="code" href="classuiBase.html#a0">tra</a>(<span class="stringliteral">"Folder is not empty. You can override this protection by clicking DEL again"</span>);
00195             $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$parid&amp;delOverride=$id"</span>;
00196             <span class="keywordflow">return</span>;
00197         }
00198 <span class="preprocessor">        #############################</span>
00199 <span class="preprocessor"></span>
00200         $r = $this-&gt;gb-&gt;deleteFile($<span class="keywordtype">id</span>, $this-&gt;sessid);
00201         <span class="keywordflow">if</span>(PEAR::isError($r)) $this-&gt;alertMsg = $r-&gt;getMessage();
00202         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.<span class="stringliteral">"?id=$parid"</span>;
00203     }
00204 
00205 
<a name="l00215"></a><a class="code" href="classuiHandler.html#a9">00215</a>     function <a class="code" href="classuiHandler.html#a9">getFile</a>($<span class="keywordtype">id</span>)
00216     {
00217         $r = $this-&gt;gb-&gt;access($<span class="keywordtype">id</span>, $this-&gt;sessid);
00218         <span class="keywordflow">if</span>(PEAR::isError($r)) $this-&gt;alertMsg = $r-&gt;getMessage();
00219         <span class="keywordflow">else</span> echo $r;
00220     }
00221 
<a name="l00229"></a><a class="code" href="classuiHandler.html#a10">00229</a>     function <a class="code" href="classuiHandler.html#a10">getMdata</a>($<span class="keywordtype">id</span>)
00230     {
00231         header(<span class="stringliteral">"Content-type: text/xml"</span>);
00232         $r = $this-&gt;gb-&gt;getMdata($<span class="keywordtype">id</span>, $this-&gt;sessid);
00233         print_r($r);
00234     }
00235 
<a name="l00244"></a><a class="code" href="classuiHandler.html#a11">00244</a>     function <a class="code" href="classuiHandler.html#a11">getInfo</a>($<span class="keywordtype">id</span>)
00245     {
00246         header(<span class="stringliteral">"Content-type: text/plain"</span>);
00247         $ia = $this-&gt;gb-&gt;analyzeFile($<span class="keywordtype">id</span>, $this-&gt;sessid);
00248         echo<span class="stringliteral">"fileformat: {$ia['fileformat']}\n"</span>;
00249         echo<span class="stringliteral">"channels: {$ia['audio']['channels']}\n"</span>;
00250         echo<span class="stringliteral">"sample_rate: {$ia['audio']['sample_rate']}\n"</span>;
00251         echo<span class="stringliteral">"bits_per_sample: {$ia['audio']['bits_per_sample']}\n"</span>;
00252         echo<span class="stringliteral">"channelmode: {$ia['audio']['channelmode']}\n"</span>;
00253         echo<span class="stringliteral">"title: {$ia['id3v1']['title']}\n"</span>;
00254         echo<span class="stringliteral">"artist: {$ia['id3v1']['artist']}\n"</span>;
00255         echo<span class="stringliteral">"comment: {$ia['id3v1']['comment']}\n"</span>;
00256     }
00257 
00258    <span class="comment">// --- subjs ----</span>
<a name="l00266"></a><a class="code" href="classuiHandler.html#a12">00266</a> <span class="comment"></span>    function <a class="code" href="classuiHandler.html#a12">addSubj</a>(&amp;$formdata, &amp;$mask)
00267     {
00268         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act='.$_REQUEST['act'];
00269 
00270 <span class="preprocessor">        ## first validate the form data</span>
00271 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ($this-&gt;_validateForm($formdata, $mask)) {
00272             <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, '<a class="code" href="ui__browser_8php.html#a5">subjects</a>')){
00273                 $res = $this-&gt;gb-&gt;addSubj($formdata['<a class="code" href="classuiHandler.html#a1">login</a>'], ($formdata['pass']=='' ? NULL:$formdata['pass'] ));
00274                 $this-&gt;alertMsg = $this-&gt;<a class="code" href="classuiBase.html#a0">tra</a>('Subject <span class="stringliteral">"'.$formdata['login'].'"</span> added.');
00275             } <span class="keywordflow">else</span> {
00276                 $this-&gt;alertMsg = $this-&gt;<a class="code" href="classuiBase.html#a0">tra</a>('Access denied.');
00277                 <span class="keywordflow">return</span>;
00278             }
00279         }
00280         <span class="keywordflow">if</span>(PEAR::isError($res)) $this-&gt;alertMsg = $res-&gt;getMessage();
00281     }
00282 
<a name="l00290"></a><a class="code" href="classuiHandler.html#a13">00290</a>     function <a class="code" href="classuiHandler.html#a13">removeSubj</a>($login)
00291     {
00292         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a5">subjects</a>';
00293 
00294         <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, '<a class="code" href="ui__browser_8php.html#a5">subjects</a>')){
00295             $res = $this-&gt;gb-&gt;removeSubj($<a class="code" href="classuiHandler.html#a1">login</a>);
00296         }<span class="keywordflow">else</span>{
00297             $this-&gt;alertMsg='Access denied.';
00298             <span class="keywordflow">return</span>;
00299         }
00300         <span class="keywordflow">if</span>(PEAR::isError($res)) $this-&gt;alertMsg = $res-&gt;getMessage();
00301     }
00302 
<a name="l00313"></a><a class="code" href="classuiHandler.html#a14">00313</a>     function <a class="code" href="classuiHandler.html#a14">passwd</a>($uid, $oldpass, $pass, $pass2)
00314     {
00315         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a5">subjects</a>';
00316         $ulogin = $this-&gt;gb-&gt;getSubjName($uid);
00317 
00318         <span class="keywordflow">if</span>($this-&gt;userid != $uid &amp;&amp;
00319             ! $this-&gt;gb-&gt;checkPerm($this-&gt;userid, '<a class="code" href="ui__browser_8php.html#a5">subjects</a>')){
00320             $this-&gt;alertMsg='Access denied..';
00321             <span class="keywordflow">return</span>;
00322         }
00323         <span class="keywordflow">if</span>(FALSE === $this-&gt;gb-&gt;authenticate($ulogin, $oldpass)){
00324             $this-&gt;alertMsg='Wrong old pasword.';
00325             <span class="keywordflow">return</span>;
00326         }
00327         <span class="keywordflow">if</span>($pass !== $pass2){
00328             $this-&gt;alertMsg = <span class="stringliteral">"Passwords do not match. "</span>.
00329                 <span class="stringliteral">"($pass/$pass2)"</span>;
00330             $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a5">subjects</a>';
00331             <span class="keywordflow">return</span>;
00332         }
00333         $this-&gt;gb-&gt;passwd($ulogin, $oldpass, $pass);
00334     }
00335 
00336     <span class="comment">// --- perms ---</span>
<a name="l00347"></a><a class="code" href="classuiHandler.html#a15">00347</a> <span class="comment"></span>    function <a class="code" href="classuiHandler.html#a15">addPerm</a>($subj, $permAction, $<span class="keywordtype">id</span>, $allowDeny)
00348     {
00349         <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, 'editPerms', $<span class="keywordtype">id</span>)){
00350             $this-&gt;gb-&gt;addPerm($subj, $permAction,
00351                 $<span class="keywordtype">id</span>, $allowDeny);
00352         }<span class="keywordflow">else</span>{
00353             $this-&gt;alertMsg='Access denied.';
00354         }
00355         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?<span class="keywordtype">id</span>='.$id.'&amp;act=<a class="code" href="ui__browser_8php.html#a1">permissions</a>';
00356     }
00357 
<a name="l00365"></a><a class="code" href="classuiHandler.html#a16">00365</a>     function <a class="code" href="classuiHandler.html#a16">removePerm</a>($permid, $oid)
00366     {
00367         <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, 'editPerms', $oid))
00368             $this-&gt;gb-&gt;removePerm($permid);
00369         <span class="keywordflow">else</span> $this-&gt;alertMsg='Access denied.';
00370         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a1">permissions</a>&amp;<span class="keywordtype">id</span>='.$id;
00371     }
00372 
00373 
<a name="l00384"></a><a class="code" href="classuiHandler.html#a17">00384</a>     function <a class="code" href="classuiHandler.html#a17">addSubj2Group</a>($login, $gname, $reid)
00385     {
00386         <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, '<a class="code" href="ui__browser_8php.html#a5">subjects</a>')){
00387             $res = $this-&gt;gb-&gt;addSubj2Gr($<a class="code" href="classuiHandler.html#a1">login</a>, $gname);
00388         }<span class="keywordflow">else</span>{
00389             $this-&gt;alertMsg='Access denied.';
00390             <span class="keywordflow">return</span>;
00391         }
00392         <span class="keywordflow">if</span>(PEAR::isError($res)) $this-&gt;alertMsg = $res-&gt;getMessage();
00393 
00394         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a8">groups</a>&amp;<span class="keywordtype">id</span>='.$reid;
00395     }
00396 
<a name="l00404"></a><a class="code" href="classuiHandler.html#a18">00404</a>     function <a class="code" href="classuiHandler.html#a18">removeSubjFromGr</a>($login, $gname, $reid)
00405     {
00406         <span class="keywordflow">if</span>($this-&gt;gb-&gt;checkPerm($this-&gt;userid, '<a class="code" href="ui__browser_8php.html#a5">subjects</a>')){
00407             $res = $this-&gt;gb-&gt;removeSubjFromGr($<a class="code" href="classuiHandler.html#a1">login</a>, $gname);
00408         }<span class="keywordflow">else</span>{
00409             $this-&gt;alertMsg='Access denied.';
00410             <span class="keywordflow">return</span>;
00411         }
00412         <span class="keywordflow">if</span>(PEAR::isError($res)) $this-&gt;alertMsg = $res-&gt;getMessage();
00413 
00414         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a8">groups</a>&amp;<span class="keywordtype">id</span>='.$reid;
00415     }
00416 
00417 
<a name="l00418"></a><a class="code" href="classuiHandler.html#a19">00418</a>     function <a class="code" href="classuiHandler.html#a19">storeSystemPrefs</a>(&amp;$formdata, &amp;$mask)
00419     {
00420 <span class="preprocessor">        ## first validate the form data</span>
00421 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ($this-&gt;_validateForm($formdata, $mask)) {
00422             $this-&gt;alertMsg = $this-&gt;<a class="code" href="classuiBase.html#a0">tra</a>('Settings saved');
00423             $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>;
00424             <span class="keywordflow">return</span>;
00425         }
00426         $this-&gt;redirUrl = <a class="code" href="conf_8php.html#a2">UI_BROWSER</a>.'?act=<a class="code" href="ui__browser_8php.html#a13">systemPrefs</a>';
00427     }
00428 
<a name="l00429"></a><a class="code" href="classuiHandler.html#a20">00429</a>     function <a class="code" href="classuiHandler.html#a20">_validateForm</a>(&amp;$formdata, &amp;$mask)
00430     {
00431         $form = <span class="keyword">new</span> HTML_QuickForm('validation', UI_STANDARD_FORM_METHOD, <a class="code" href="conf_8php.html#a1">UI_HANDLER</a>);
00432         $this-&gt;<a class="code" href="classuiBase.html#a1">_parseArr2Form</a>($form, $mask, 'server');
00433         <span class="keywordflow">if</span> (!$form-&gt;validate()) {
00434             $_SESSION['retransferFormData'] = $formdata;
00435             <span class="keywordflow">return</span> FALSE;
00436         }
00437 <span class="preprocessor">        ## test for uploadet files ####</span>
00438 <span class="preprocessor"></span>        foreach($mask as $k) {
00439             <span class="keywordflow">if</span> ($k['type']=='file') {
00440                 <span class="keywordflow">if</span> ($formdata[$k['element']]['error']) {
00441                     $_SESSION['retransferFormData'] = $formdata;
00442                     <span class="keywordflow">return</span> FALSE;
00443                 }
00444             }
00445         }
00446         reset($mask);
00447         <span class="keywordflow">return</span> TRUE;
00448     }
00449 
00450 }
00451 
00452 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jan 12 16:22:49 2005 for LiveSupport&nbsp;-&nbsp;htmlUI&nbsp;module by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
